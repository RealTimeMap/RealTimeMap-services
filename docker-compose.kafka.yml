#services:
#  zookeeper:
#    image: confluentinc/cp-zookeeper:7.6.0
#    container_name: zookeeper
#    restart: always
#    # Порт закрыт для публичного доступа
#    # Для локальной разработки раскомментируйте:
#    # ports:
#    #   - "2181:2181"
#    environment:
#      ZOOKEEPER_CLIENT_PORT: 2181
#      ZOOKEEPER_TICK_TIME: 2000
#    healthcheck:
#      test: ["CMD-SHELL", "echo ruok | nc localhost 2181 | grep imok"]
#      interval: 10s
#      timeout: 5s
#      retries: 5
#    volumes:
#      - zookeeper_data:/var/lib/zookeeper/data
#      - zookeeper_logs:/var/lib/zookeeper/log
#    networks:
#      - realtimemap-network
#
#  kafka:
#    image: confluentinc/cp-kafka:7.6.0
#    container_name: kafka
#    restart: always
#    # Порты закрыты для публичного доступа
#    # Для локальной разработки раскомментируйте:
#    # ports:
#    #   - "9092:9092"
#    #   - "9093:9093"
#    environment:
#      KAFKA_BROKER_ID: 1
#      KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181
#
#      # Listeners configuration
#      KAFKA_LISTENERS: INTERNAL://0.0.0.0:9092,EXTERNAL://0.0.0.0:9093
#      KAFKA_ADVERTISED_LISTENERS: INTERNAL://kafka:9092,EXTERNAL://localhost:9093
#      KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: INTERNAL:PLAINTEXT,EXTERNAL:PLAINTEXT
#      KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL
#
#      # Topic defaults
#      KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR: 1
#      KAFKA_TRANSACTION_STATE_LOG_MIN_ISR: 1
#      KAFKA_TRANSACTION_STATE_LOG_REPLICATION_FACTOR: 1
#
#      # Performance settings
#      AUTO_CREATE_TOPICS: "true"
#      KAFKA_LOG_RETENTION_HOURS: 168
#    healthcheck:
#      test: ["CMD-SHELL", "kafka-broker-api-versions --bootstrap-server localhost:9092"]
#      interval: 10s
#      timeout: 10s
#      retries: 5
#    volumes:
#      - kafka_data:/var/lib/kafka/data
#    networks:
#      - realtimemap-network
#    depends_on:
#      zookeeper:
#        condition: service_healthy
#
#  kafka-ui:
#    image: provectuslabs/kafka-ui:latest
#    container_name: kafka-ui
#    restart: always
#    # Kafka UI можно оставить доступным для мониторинга
#    # Или закрыть и проксировать через nginx
#    ports:
#      - "8090:8080"
#    environment:
#      DYNAMIC_CONFIG_ENABLED: "true"
#      KAFKA_CLUSTERS_0_NAME: local
#      KAFKA_CLUSTERS_0_BOOTSTRAPSERVERS: kafka:9092
#      KAFKA_CLUSTERS_0_ZOOKEEPER: zookeeper:2181
#    networks:
#      - realtimemap-network
#    depends_on:
#      kafka:
#        condition: service_healthy
#
#volumes:
#  zookeeper_data:
#  zookeeper_logs:
#  kafka_data:
#
## Подключаемся к общей сети
#networks:
#  realtimemap-network:
#    internal: true